<html>
<head>
	<script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script type="text/javascript">
    	var getSiteKey = function() {
		    var regexS = "[\\?&]siteKey=([^&#]*)";
		    var regex = new RegExp( regexS );
		    var results = regex.exec( window.location.href );
		    if( results == null ) {
		    	return "";
		    } else {
		    	return results[1];
		    }
		};
		var verifyCallback = function(response) {
			console.log (response);
			parent.postMessage(response, '*');
		};
		var recaptchaCallback = function() {
			var siteKey = getSiteKey();
			grecaptcha.render('recaptcha', {
				'sitekey' : siteKey,
				'callback' : verifyCallback,
				'theme' : 'light',
				'size' : 'normal'
			});
		};
      var checkConnection = function() {
      console.log ('checkConnection');
      	if (typeof grecaptcha === "undefined") {
      		parent.postMessage('NOT_REACHABLE', '*');
      	}
      };
    </script>
</head>

<body>
	<div class="g-recaptcha" data-sitekey="6LenNyUTAAAAAF4pstt16ngGn6O7nEgTR3Outwjy"></div>
	<script>
		window.setTimeout(checkConnection, 5000);
		document.cookie = "username=John Doe";
	</script>
</body>
</html>
